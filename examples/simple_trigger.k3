declare events : {|(int,int)|}

trigger on_event(a:int, b:int) {} = do {
  insert(events, (a,b));
  iterate(\(na:int, nb:int) -> insert(events,(na,nb)), map(\(a:int, b:int) -> (a, b+1), events));
  send(on_event, localhost:10000, a,b)
}

role client {
  source  s1 : (int, int) = file("test.csv", csv)
  bind    s1 -> on_event
  consume s1
}

default role client
